import{j as e,A as R,m as r}from"./animation-vendor-Bf7mgj-L.js";import{u as G,a as l}from"./react-vendor-DVGsTovx.js";import{z as J}from"./index-Bb-Xk9BK.js";import{X as $,$ as Q,m as W,a0 as _,a1 as ee,f as L,a as te,b as M,U as se,F as ae,j as ie}from"./ui-vendor-D2hm-2DB.js";function de({car:s,onClose:m,isEmbedded:P=!1,onReserve:y}){const z=G(),[h,b]=l.useState(0),[j,k]=l.useState(null),[N,C]=l.useState(null),[n,o]=l.useState(!1),[g,d]=l.useState(1),[u,c]=l.useState({x:0,y:0}),[T,S]=l.useState(!1),[v,H]=l.useState({x:0,y:0}),D=l.useRef(null),Z=l.useRef(null),i=s?.mainImage?[s.mainImage,...s.images?.filter(t=>t!==s.mainImage)||[]]:s?.images&&s.images.length>0?s.images:[],E=i[h]||s?.mainImage;if(!s)return null;const f=l.useCallback(()=>{b(t=>(t+1)%i.length),o(!1),d(1),c({x:0,y:0})},[i.length]),w=l.useCallback(()=>{b(t=>(t-1+i.length)%i.length),o(!1),d(1),c({x:0,y:0})},[i.length]),A=t=>{k(t.targetTouches[0].clientX)},X=t=>{C(t.targetTouches[0].clientX)},F=()=>{if(!j||!N)return;const t=j-N,a=t>50,x=t<-50;a&&i.length>1&&f(),x&&i.length>1&&w(),k(null),C(null)};l.useEffect(()=>{const t=a=>{a.key==="Escape"?m():a.key==="ArrowLeft"&&i.length>1?w():a.key==="ArrowRight"&&i.length>1&&f()};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[m,w,f,i.length]);const O=()=>{m(),P&&y?y(s):(z(`/reservation/${s.id}`),J.success("Redirecting to reservation page"))},U=()=>{d(t=>Math.min(t+.5,5)),o(!0)},Y=()=>{d(t=>{const a=Math.max(t-.5,1);return a===1&&(o(!1),c({x:0,y:0})),a})},B=()=>{n||(o(!0),d(2))},K=t=>{n&&g>1&&(S(!0),H({x:t.clientX-u.x,y:t.clientY-u.y}))};return l.useEffect(()=>{if(n){const t=p=>{if(n){p.preventDefault();const V=p.deltaY>0?-.2:.2;d(q=>{const I=Math.max(1,Math.min(q+V,5));return I===1&&(o(!1),c({x:0,y:0})),I})}},a=p=>{T&&n&&c({x:p.clientX-v.x,y:p.clientY-v.y})},x=()=>{S(!1)};return document.addEventListener("mousemove",a),document.addEventListener("mouseup",x),document.addEventListener("wheel",t,{passive:!1}),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",x),document.removeEventListener("wheel",t)}}},[n,T,v]),e.jsx(R,{children:e.jsx(r.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:m,className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/80 dark:bg-black/90 backdrop-blur-sm",children:e.jsxs(r.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:300},onClick:t=>t.stopPropagation(),className:"relative bg-white dark:bg-indigo-950/90 rounded-2xl sm:rounded-3xl shadow-2xl w-full max-w-6xl max-h-[95vh] overflow-hidden flex flex-col transition-colors duration-300",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:[e.jsx("div",{className:"absolute top-4 right-4 z-30 flex items-center gap-2",children:e.jsx(r.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:m,className:"p-2 bg-white/90 dark:bg-indigo-950/80 backdrop-blur-sm rounded-full shadow-lg hover:bg-white dark:hover:bg-indigo-900 transition-colors duration-150","aria-label":"Close",title:"Close (ESC)",children:e.jsx($,{className:"w-5 h-5 text-gray-700 dark:text-white"})})}),e.jsxs("div",{className:"flex flex-col md:flex-row flex-1 overflow-hidden",children:[e.jsxs("div",{className:"md:w-3/5 bg-white/90 dark:bg-indigo-950/80 backdrop-blur-md rounded-xl shadow-2xl border border-gray-200/50 dark:border-purple-800/30 flex flex-col transition-colors duration-300 p-3 md:p-4",children:[e.jsx("div",{className:"flex-1 relative overflow-hidden rounded-lg mb-2",style:{minHeight:"300px"},children:e.jsxs("div",{ref:D,className:"relative w-full h-full",onTouchStart:A,onTouchMove:X,onTouchEnd:F,children:[e.jsx(R,{mode:"wait",children:E?e.jsx(r.div,{initial:{opacity:0,x:0},animate:{opacity:1,x:0},exit:{opacity:0,x:0},transition:{duration:.2},className:"w-full h-full flex items-center justify-center p-4 cursor-zoom-in",ref:Z,onClick:B,onMouseDown:K,style:{overflow:n?"hidden":"visible"},children:e.jsx(r.img,{src:E,alt:`${s.name} - Image ${h+1}`,className:`max-w-full max-h-full object-contain rounded-xl shadow-lg transition-transform duration-200 ${n?"cursor-move":"cursor-zoom-in"}`,loading:"eager",decoding:"async",style:{transform:`translate(${u.x}px, ${u.y}px) scale(${g})`,transformOrigin:"center center"}})},h):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 dark:text-gray-500",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"w-32 h-32 mx-auto mb-4 bg-gray-300 dark:bg-gray-700 rounded-2xl flex items-center justify-center",children:e.jsx($,{className:"w-16 h-16 text-gray-400 dark:text-gray-500"})}),e.jsx("p",{className:"text-lg dark:text-gray-400",children:"No image available"})]})})}),i.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(r.button,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{duration:.1},onClick:t=>{t.stopPropagation(),w()},className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 opacity-80 hover:opacity-100 transition-opacity","aria-label":"Previous image",title:"Previous image (←)",children:e.jsx(Q,{className:"w-8 h-8 text-purple-300 dark:text-purple-400 drop-shadow-lg"})}),e.jsx(r.button,{whileHover:{scale:1.1},whileTap:{scale:.9},transition:{duration:.1},onClick:t=>{t.stopPropagation(),f()},className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 opacity-80 hover:opacity-100 transition-opacity","aria-label":"Next image",title:"Next image (→)",children:e.jsx(W,{className:"w-8 h-8 text-purple-300 dark:text-purple-400 drop-shadow-lg"})})]}),n&&e.jsxs("div",{className:"absolute top-4 left-4 flex items-center gap-2 p-2 bg-black/70 backdrop-blur-sm rounded-lg z-20",children:[e.jsx(r.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:t=>{t.stopPropagation(),U()},className:"p-2 bg-white/20 hover:bg-white/30 rounded text-white transition-colors",disabled:g>=5,children:e.jsx(_,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-white text-xs px-2",children:[Math.round(g*100),"%"]}),e.jsx(r.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:t=>{t.stopPropagation(),Y()},className:"p-2 bg-white/20 hover:bg-white/30 rounded text-white transition-colors",disabled:g<=1,children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx(r.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:t=>{t.stopPropagation(),d(1),o(!1),c({x:0,y:0})},className:"p-2 bg-white/20 hover:bg-white/30 rounded text-white transition-colors text-xs",children:"Reset"})]})]})}),i.length>0&&e.jsx("div",{className:"text-center mb-2",children:e.jsxs("span",{className:"text-xs md:text-sm text-gray-600 dark:text-gray-400",children:[h+1," / ",i.length," photos"]})}),i.length>1&&e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"flex gap-2 justify-center overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-purple-700 scrollbar-track-transparent",children:i.map((t,a)=>e.jsx(r.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:x=>{x.stopPropagation(),b(a)},className:`flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 transition-all duration-200 ${h===a?"border-indigo-600 dark:border-purple-400 shadow-lg ring-2 ring-indigo-200 dark:ring-purple-800":"border-gray-300 dark:border-gray-600 hover:border-indigo-400 dark:hover:border-purple-500"}`,"aria-label":`View image ${a+1}`,title:`Image ${a+1}`,children:e.jsx("img",{src:t,alt:`Thumbnail ${a+1}`,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-200",loading:"lazy",decoding:"async"})},a))})}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-purple-800/30 mb-3"}),e.jsxs(r.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:O,disabled:!1,className:"w-full py-3 px-4 sm:py-4 sm:px-6 rounded-xl font-semibold text-white shadow-lg transition-all duration-150 flex items-center justify-center gap-2 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 hover:shadow-xl",children:[e.jsx(L,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Book now"})]})]}),e.jsx("div",{className:"md:w-2/5 p-4 md:p-6 lg:p-8 overflow-y-auto flex flex-col bg-white dark:bg-indigo-950/40 transition-colors duration-300",children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center text-white text-sm font-semibold border-2 border-white dark:border-purple-800/50 shadow-md",children:s.owner?s.owner.charAt(0).toUpperCase():"O"}),e.jsx("p",{className:"text-base font-semibold text-gray-900 dark:text-white",children:s.owner??"—"})]}),e.jsx("div",{className:"h-px bg-gray-200 dark:bg-purple-800/30"}),e.jsx("div",{children:e.jsx("h2",{id:"modal-title",className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-4 leading-tight",children:s.name})}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-3",children:e.jsx("h3",{className:"text-lg font-semibold text-indigo-600 dark:text-purple-400",children:"Car details:"})}),e.jsxs("div",{className:"space-y-2 pl-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(te,{className:"w-4 h-4 text-indigo-600 dark:text-purple-400 flex-shrink-0"}),e.jsxs("span",{children:["City: ",e.jsx("span",{className:"font-medium",children:s.city||"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(M,{className:"w-4 h-4 text-indigo-600 dark:text-purple-400 flex-shrink-0"}),e.jsxs("span",{children:["Brand: ",e.jsx("span",{className:"font-medium",children:s.brand||"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(se,{className:"w-4 h-4 text-indigo-600 dark:text-purple-400 flex-shrink-0"}),e.jsxs("span",{children:["Seats: ",e.jsx("span",{className:"font-medium",children:s.seats||"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(M,{className:"w-4 h-4 text-indigo-600 dark:text-purple-400 flex-shrink-0"}),e.jsxs("span",{children:["Type: ",e.jsx("span",{className:"font-medium",children:s.gearbox||s.type||"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(ae,{className:"w-4 h-4 text-indigo-600 dark:text-purple-400 flex-shrink-0"}),e.jsxs("span",{children:["Fuel Type: ",e.jsx("span",{className:"font-medium",children:s.fuel||"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(L,{className:"w-4 h-4 text-indigo-600 dark:text-purple-400 flex-shrink-0"}),e.jsxs("span",{children:["Times Rented: ",e.jsx("span",{className:"font-medium",children:s.timesRented!==void 0?s.timesRented:"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(ie,{className:"w-4 h-4 text-indigo-600 dark:text-purple-400 flex-shrink-0"}),e.jsxs("span",{children:["Minimum Rating: ",e.jsx("span",{className:"font-medium",children:s.rating!==void 0?`${s.rating} / 5`:"—"})]})]})]})]}),e.jsxs("div",{className:"pt-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-indigo-600 dark:text-purple-400 mb-3",children:"Description:"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed whitespace-pre-wrap",children:s.description||s.ownerDescription||"No description provided by the owner."})]})]})})]})]})})})}export{de as default};
